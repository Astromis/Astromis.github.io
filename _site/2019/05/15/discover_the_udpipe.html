<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Discover the UDpipe | Astromis notes</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Discover the UDpipe" />
<meta name="author" content="Astromis" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Recently, I had to get syntactic dependancy tree for my experements with sentence comprssion. There is one trouble - for russian language is pretty hard to find a good parser. Of course, there is syntax net fro google, but I didn’t want to dive into problems with dependances, version incopatibility and so on. So, I just was searching more simpler. And I’ve found. It is Universal Dependency Pipeline or UDPipe by Czech developer. This is c++ written framework that allows tokenize, tag and parse text. All you need is pre-treined model that for some languages can be downloaded or trained by yourself. This is sounds like a doubt, but don’t worry - to learn this model is pretty simple. Moreover, this framework can be runned as REST web server or library(the executble setting is running by default). SWIG makes it possibly to wrapp up code for other languages such as Python, Java, R, Prel." />
<meta property="og:description" content="Recently, I had to get syntactic dependancy tree for my experements with sentence comprssion. There is one trouble - for russian language is pretty hard to find a good parser. Of course, there is syntax net fro google, but I didn’t want to dive into problems with dependances, version incopatibility and so on. So, I just was searching more simpler. And I’ve found. It is Universal Dependency Pipeline or UDPipe by Czech developer. This is c++ written framework that allows tokenize, tag and parse text. All you need is pre-treined model that for some languages can be downloaded or trained by yourself. This is sounds like a doubt, but don’t worry - to learn this model is pretty simple. Moreover, this framework can be runned as REST web server or library(the executble setting is running by default). SWIG makes it possibly to wrapp up code for other languages such as Python, Java, R, Prel." />
<link rel="canonical" href="http://localhost:4000/2019/05/15/discover_the_udpipe.html" />
<meta property="og:url" content="http://localhost:4000/2019/05/15/discover_the_udpipe.html" />
<meta property="og:site_name" content="Astromis notes" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-05-15T00:00:00+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Discover the UDpipe" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Astromis"},"dateModified":"2019-05-15T00:00:00+03:00","datePublished":"2019-05-15T00:00:00+03:00","description":"Recently, I had to get syntactic dependancy tree for my experements with sentence comprssion. There is one trouble - for russian language is pretty hard to find a good parser. Of course, there is syntax net fro google, but I didn’t want to dive into problems with dependances, version incopatibility and so on. So, I just was searching more simpler. And I’ve found. It is Universal Dependency Pipeline or UDPipe by Czech developer. This is c++ written framework that allows tokenize, tag and parse text. All you need is pre-treined model that for some languages can be downloaded or trained by yourself. This is sounds like a doubt, but don’t worry - to learn this model is pretty simple. Moreover, this framework can be runned as REST web server or library(the executble setting is running by default). SWIG makes it possibly to wrapp up code for other languages such as Python, Java, R, Prel.","headline":"Discover the UDpipe","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/05/15/discover_the_udpipe.html"},"url":"http://localhost:4000/2019/05/15/discover_the_udpipe.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Astromis notes" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Astromis notes</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Discover the UDpipe</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-05-15T00:00:00+03:00" itemprop="datePublished">May 15, 2019
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Astromis</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Recently, I had to get syntactic dependancy tree for my experements with sentence comprssion. There is one trouble - for russian language is pretty hard to find a good parser. Of course, there is syntax net fro google, but I didn’t want to dive into problems with dependances, version incopatibility and so on. So, I just was searching more simpler. And I’ve found. It is Universal Dependency Pipeline or UDPipe by Czech developer. This is c++ written framework that allows tokenize, tag and parse text. All you need is pre-treined model that for some languages can be downloaded or trained by yourself. This is sounds like a doubt, but don’t worry - to learn this model is pretty simple. Moreover, this framework can be runned as REST web server or library(the executble setting is running by default). SWIG makes it possibly to wrapp up code for other languages such as Python, Java, R, Prel.</p>

<p>So at first, we need to download source codes through git:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/ufal/udpipe.git
</code></pre></div></div>
<p>Next, we go to ./src directory and run make</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd udpipe
make
</code></pre></div></div>
<p>After that, we will obtain udpipe executble file.</p>

<p>Now, we need in model. You can download a pre-trained model pack from <a href="http://ufal.mff.cuni.cz/udpipe/models">official site</a>. Just check your version and follow the content. It wouldn’t be hard.
If there is no model for your language like for Russian, let’s try to find data for training <a href="https://github.com/UniversalDependencies">here</a>. Among the repositories you can try to search repo that contains treebank for requaired language as for Russian SynTagRus.</p>

<p>Download it</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/UniversalDependencies/UD_Russian-SynTagRus.git
</code></pre></div></div>
<p>The things in that we have interest is ru_syntagrus-ud-dev(-train -test).conllu This is trebank that dividing to training and testing parts.</p>

<p>Now, to train the UDPipe model tun this command from src directory</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat UD_Russian-SynTagRus/ru_syntagrus-ud-train.conllu | ./udpipe/src/udpipe --train rus_model
</code></pre></div></div>
<p>where rus_model is name of file in which model will be seved. So this process take some time, because tolenizer, tagger and parser are training.</p>

<p>It is good so far, but let’s wrapp up this with Python just to speed up protoryping process. You can use pip or maniually compile this for both Python2.7 and Python3+. 
For automatical installation just type</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install ufal.udpipe
</code></pre></div></div>
<p>For maniually compiling go to downloaded git repo in ./repo/bindings/python directory and just run</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make PYTON_INCLUDE=/path/to/python/include
</code></pre></div></div>
<p>What does this mean? You have to specify where python includes are. If you are using system python, make sure that you have installed python-dev(python3-dev) packege and type</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make PYTHON_INCLUDE=/usr/include/pythonX.Xm/
</code></pre></div></div>
<p>Why is it important? I don’t know yet, but empirically, if you are using anaconda, you should specify includes containing whithin anaconda, for example (Let’s assume, that anaconda3 have been installed in user home directory)</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make <span class="nv">PYTHON_INCLUDE</span><span class="o">=</span>/home/user_name/anaconda3/include/pythonX.Xm
</code></pre></div></div>
<p>If you didn’t do this, it woulde cause problems with using of this.</p>

<p>Finally, you’ll get some files and trap is that make file doesn’t have an install option. I don’t understand yet how to correctly add all files in right places by hand, but in place in which you have compiled package all will work well.</p>

<p>Author provides two scripts as exapmles of using udpipe. One of these bindings/python/exapmes/udpipe_model.py describes usefull class that makes easy to use to work with library. Here is an example of using directly from a file:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="s">'rus_model'</span><span class="p">)</span>
<span class="n">sentences</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">tokenize</span><span class="p">(</span><span class="s">"Мама мыла раму."</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">:</span>
  <span class="n">model</span><span class="p">.</span><span class="n">tag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
  <span class="n">model</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">conllu</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">sentences</span><span class="p">,</span> <span class="s">"conllu"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">conllu</span><span class="p">)</span>
</code></pre></div></div>

<p>The whole code you can see you own it is pretty easy and clearly.</p>

<p>Here a couple of phrases about data representation. UDpip uses an CoNLL-U format that for syntax representation looks like that</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># sent_id = 1
# text = They buy and sell books.
1   They     they    PRON    PRP    Case=Nom|Number=Plur               2   nsubj   2:nsubj|4:nsubj   _
2   buy      buy     VERB    VBP    Number=Plur|Person=3|Tense=Pres    0   root    0:root            _
3   and      and     CONJ    CC     _                                  4   cc      4:cc              _
4   sell     sell    VERB    VBP    Number=Plur|Person=3|Tense=Pres    2   conj    0:root|2:conj     _
5   books    book    NOUN    NNS    Number=Plur                        2   obj     2:obj|4:obj       SpaceAfter=No
6   .        .       PUNCT   .      _                                  2   punct   2:punct  
</code></pre></div></div>
<p>Here is 10 columns named</p>
<ul>
  <li>ID - word index</li>
  <li>FORM - word form or punctuation symbol</li>
  <li>LEMMA - lemma or stem of word form</li>
  <li>UPOS - universal part of speech tag</li>
  <li>XPOS - language specific part of speech tag</li>
  <li>FEATS - list of morphological features</li>
  <li>HEAD - head of the current word, which is either a value of ID or zero (0)</li>
  <li>DEPREL - universal dependency relation to the HEAD (root if HEAD = 0) or a defined language-specific subtype of one</li>
  <li>DEPS - enhanced dependency graph in the form of a list of head-deprel pairs</li>
  <li>MISC - any other annotation.</li>
</ul>

<p>More about format you can found on <a href="http://universaldependencies.org/format.html">official site</a></p>

<p>Using HEAD and ID fields we can build a dependancy tree. There are several servicies that can drawn the tree, <a href="http://www.let.rug.nl/kleiweg/conllu/">for example</a></p>

<p><img src="/assets/images/syntax_tree_example.png" alt="Here is a screenshot of the tree" title="Example of tree visualisation" /></p>

<p><a href="https://github.com/EmilStenstrom/conllu">This repo</a> contains a nice and light python library that can give you a way to manipulate CoNLL-U data.</p>

<p>Links</p>

<p>http://wiki.apertium.org/wiki/UDPipe</p>

<p>Official site:
http://ufal.mff.cuni.cz/udpipe</p>

<p>CoNNL-U format:
http://universaldependencies.org/format.html</p>

<p>Repo with treebanks
https://github.com/UniversalDependencies</p>

  </div><a class="u-url" href="/2019/05/15/discover_the_udpipe.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Astromis notes</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Astromis notes</li><li><a class="u-email" href="mailto:buyanov.igor.o@yandex.ru">buyanov.igor.o@yandex.ru</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Astromis"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Astromis</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Data Science, Natural Language Processing, Knowledge</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
